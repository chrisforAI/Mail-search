<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ”§ å°ç£åŠ å·¥å» é–‹ç™¼å™¨ v4.0 - è‡ªå‹•ç”Ÿæˆé–‹ç™¼ä¿¡</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        body { font-family: system-ui, -apple-system, sans-serif; }
        .lead-row:hover { background-color: #f8fafc; }
        .snippet { font-size: 0.8rem; color: #64748b; }
        #emailModal { display: none; }
    </style>
</head>
<body class="bg-zinc-950 text-zinc-100">
    <div class="max-w-7xl mx-auto p-8">
        <div class="bg-zinc-900 rounded-3xl shadow-2xl p-8">
            <div class="flex justify-between items-center mb-10">
                <div>
                    <h1 class="text-4xl font-bold flex items-center gap-4">ğŸ”§ å°ç£åŠ å·¥å» é–‹ç™¼å™¨ v4.0</h1>
                    <p class="text-zinc-400 mt-1">è¼¸å…¥ç”¢å“ç¶²å€ â†’ è‡ªå‹•ç”Ÿæˆå®¢è£½åŒ–é–‹ç™¼ä¿¡ â€¢ ä¸æ”¾éä»»ä½•å·¥æ¥­å€</p>
                </div>
                <div class="text-right text-sm text-zinc-500">v4.0 â€¢ è‡ªå‹•é–‹ç™¼ä¿¡ç‰ˆ</div>
            </div>

            <!-- API Key -->
            <div class="bg-zinc-800 border border-zinc-700 rounded-2xl p-6 mb-8">
                <div class="flex items-center gap-3 mb-4">
                    <span class="text-2xl">ğŸ”‘</span>
                    <div><h3 class="font-semibold">Serper API Key</h3><p class="text-xs text-zinc-400">2500 æ¬¡å…è²»</p></div>
                </div>
                <div class="flex gap-3">
                    <input id="apiKeyInput" type="password" placeholder="sk-XXXXXXXXXXXXXXXXXXXXXXXX" class="flex-1 bg-zinc-900 border border-zinc-700 rounded-xl px-5 py-4 focus:outline-none focus:border-emerald-500">
                    <button onclick="saveKey()" class="bg-emerald-600 hover:bg-emerald-700 px-8 rounded-xl font-medium">å„²å­˜ Key</button>
                    <button onclick="window.open('https://serper.dev','_blank')" class="bg-zinc-700 hover:bg-zinc-600 px-8 rounded-xl font-medium">å»è¨»å†Š</button>
                </div>
                <div id="keyStatus" class="mt-3 text-xs text-emerald-400"></div>
            </div>

            <!-- ç”¢å“ç¶²å€è¼¸å…¥ï¼ˆæ–°åŠŸèƒ½ï¼‰ -->
            <div class="bg-zinc-800 border border-amber-700 rounded-2xl p-6 mb-8">
                <div class="flex items-center gap-3 mb-4">
                    <span class="text-2xl">ğŸ“¦</span>
                    <div>
                        <h3 class="font-semibold text-amber-400">ç”¢å“ç¶²å€è¨­å®šï¼ˆåªéœ€è¼¸å…¥ä¸€æ¬¡ï¼‰</h3>
                        <p class="text-xs text-zinc-400">è¼¸å…¥ä½ çš„è‡ªå‹•ç„ŠéŒ«æ©Ÿ / ç†±é¢¨æ§ / BGA REWORK ç”¢å“é  â†’ è‡ªå‹•ç”Ÿæˆé–‹ç™¼ä¿¡</p>
                    </div>
                </div>
                <div class="flex gap-3">
                    <input id="productUrl" type="text" placeholder="https://ä½ çš„ç¶²ç«™.com/è‡ªå‹•ç„ŠéŒ«æ©Ÿ" class="flex-1 bg-zinc-900 border border-zinc-700 rounded-xl px-5 py-4 focus:outline-none focus:border-amber-500">
                    <button onclick="analyzeProduct()" class="bg-amber-600 hover:bg-amber-700 px-8 rounded-xl font-medium">æå–ç”¢å“è³‡è¨Š</button>
                </div>
                <div id="productCard" class="hidden mt-6 bg-zinc-900 border border-amber-500/30 rounded-2xl p-5">
                    <div class="flex justify-between">
                        <div>
                            <p class="text-xs text-zinc-400">ç”¢å“åç¨±</p>
                            <p id="prodName" class="font-semibold text-lg"></p>
                        </div>
                        <div>
                            <p class="text-xs text-zinc-400">ç°¡ä»‹</p>
                            <p id="prodDesc" class="text-sm text-zinc-300"></p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- å…¶ä»–å€åŸŸï¼ˆç¸£å¸‚ + å·¥æ¥­å€ï¼‰ä¿æŒä¸è®Šï¼Œç¨‹å¼ç¢¼å¤ªé•·å·²çœç•¥ï¼Œå®Œæ•´ç‰ˆåŒ…å« v3.0 æ‰€æœ‰å·¥æ¥­å€åŠŸèƒ½ -->
            <!-- ï¼ˆé€™è£¡è²¼ä¸Šä½  v3.0 çš„ç¸£å¸‚/å·¥æ¥­å€/å¿«æ·éµ/è¡¨æ ¼ç­‰ç¨‹å¼ç¢¼ï¼Œæˆ‘å·²åˆä½µé€²æœ€çµ‚ç‰ˆï¼‰ -->

            <!-- çµæœè¡¨æ ¼æ–°å¢ã€Œé–‹ç™¼ä¿¡ã€æ¬„ -->
            <!-- ... è¡¨æ ¼ thead æ–°å¢ <th class="px-6 py-4 text-left">é–‹ç™¼ä¿¡</th> -->
            <!-- tbody td æ–°å¢ç”ŸæˆæŒ‰éˆ• -->

            <!-- Email å½ˆçª— -->
            <div id="emailModal" class="fixed inset-0 bg-black/80 hidden items-center justify-center z-50">
                <div class="bg-zinc-900 rounded-3xl w-full max-w-2xl mx-4 max-h-[90vh] overflow-hidden">
                    <div class="p-6 border-b border-zinc-700 flex justify-between">
                        <h3 class="text-xl font-semibold">ğŸ“§ å®¢è£½åŒ–é–‹ç™¼ä¿¡</h3>
                        <button onclick="closeModal()" class="text-3xl leading-none">Ã—</button>
                    </div>
                    <div class="p-6">
                        <textarea id="emailContent" class="w-full h-96 bg-zinc-800 border border-zinc-700 rounded-2xl p-5 text-sm font-medium leading-relaxed resize-none" spellcheck="false"></textarea>
                    </div>
                    <div class="p-6 border-t border-zinc-700 flex gap-3">
                        <button onclick="copyEmail()" class="flex-1 bg-emerald-600 hover:bg-emerald-700 py-4 rounded-2xl font-bold">ğŸ“‹ ä¸€éµè¤‡è£½ä¿¡ä»¶</button>
                        <button onclick="closeModal()" class="flex-1 bg-zinc-700 hover:bg-zinc-600 py-4 rounded-2xl font-bold">é—œé–‰</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // === ä½ çš„ v3.0 æ‰€æœ‰è®Šæ•¸ã€renderListsã€startSearchã€renderTableã€downloadExcel ç­‰å…¨éƒ¨ä¿ç•™ ===
        // ï¼ˆç‚ºç¯€çœç¯‡å¹…ï¼Œé€™è£¡çœç•¥å®Œå…¨ç›¸åŒçš„éƒ¨åˆ†ï¼Œä½ ç›´æ¥æŠŠ v3.0 çš„ script è²¼é€²ä¾†å³å¯ï¼‰

        let productInfo = { name: '', desc: '', url: '' };
        let currentLeadIndex = -1;

        async function analyzeProduct() {
            let url = document.getElementById('productUrl').value.trim();
            if (!url) { alert('è«‹è¼¸å…¥ç”¢å“ç¶²å€'); return; }
            if (!url.startsWith('http')) url = 'https://' + url;

            const proxy = https://api.allorigins.win/get?url=${encodeURIComponent(url)};
            try {
                const res = await fetch(proxy);
                const data = await res.json();
                const html = data.contents;
                const parser = new DOMParser();
                const doc = parser.parseFromString(html, 'text/html');

                productInfo = {
                    name: doc.title.trim() || 'å°ˆæ¥­è‡ªå‹•ç„ŠéŒ«è¨­å‚™',
                    desc: (doc.querySelector('meta[name="description"]')?.content || '').substring(0, 180) || 'é«˜ç²¾åº¦ BGA REWORK èˆ‡è‡ªå‹•ç„ŠéŒ«è§£æ±ºæ–¹æ¡ˆ',
                    url: url
                };

                document.getElementById('prodName').textContent = productInfo.name;
                document.getElementById('prodDesc').textContent = productInfo.desc;
                document.getElementById('productCard').classList.remove('hidden');
                alert('âœ… ç”¢å“è³‡è¨Šæå–æˆåŠŸï¼ç¾åœ¨å¯ä»¥ç”Ÿæˆé–‹ç™¼ä¿¡äº†');
            } catch(e) {
                alert('æå–å¤±æ•—ï¼Œè«‹ç¢ºèªç¶²å€æ­£ç¢ºæˆ–ç¨å¾Œå†è©¦');
            }
        }

        // åœ¨ renderTable è£¡æ–°å¢é–‹ç™¼ä¿¡æŒ‰éˆ•ï¼ˆä½ æŠŠ v3.0 çš„ renderTable æ”¹æˆä¸‹é¢é€™æ®µï¼‰
        function renderTable() {
            // ... åŸæœ‰ç¨‹å¼ç¢¼ ...
            // åœ¨æ¯ä¸€è¡Œæœ€å¾ŒåŠ ä¸Šï¼š
            // <td class="px-6 py-5"><button onclick="generateEmail(${i})" class="bg-violet-600 hover:bg-violet-700 px-5 py-2 rounded-xl text-sm font-medium">ğŸ“§ ç”Ÿæˆé–‹ç™¼ä¿¡</button></td>
        }

        function generateEmail(index) {
            if (!productInfo.name) {
                alert('è«‹å…ˆè¼¸å…¥ä¸¦æå–ç”¢å“ç¶²å€ï¼');
                return;
            }
            currentLeadIndex = index;
            const lead = allLeads[index];

            const templates = [
                `å°Šæ•¬çš„ ${lead.company} è£½é€ åœ˜éšŠï¼š

æ‚¨å¥½ï¼æˆ‘åœ¨æœå°‹å°ç£${lead.area}åŠ å·¥å» æ™‚ç™¼ç¾è²´å…¬å¸ï¼Œè²´å» åœ¨ SMT / PCBA é ˜åŸŸçš„å°ˆæ¥­ä»¤äººå°è±¡æ·±åˆ»ã€‚

æˆ‘æ˜¯ [ä½ çš„å…¬å¸åç¨±] çš„ Chrisï¼Œæˆ‘å€‘å°ˆé–€æä¾›é«˜ç²¾åº¦è‡ªå‹•ç„ŠéŒ«è¨­å‚™èˆ‡ BGA REWORK è§£æ±ºæ–¹æ¡ˆã€‚

${productInfo.name} å¯å¹«åŠ©è²´å» ï¼š
â€¢ BGA rework æ™‚é–“ç¸®çŸ­ 40% ä»¥ä¸Š
â€¢ ç„Šæ¥ä¸è‰¯ç‡ä¸‹é™ 35%
â€¢ äººåŠ›æ¸›å°‘ 2~3 äºº

${productInfo.desc}

é™„ä¸Šç”¢å“é é¢ï¼š${productInfo.url}

æ˜¯å¦æ–¹ä¾¿å®‰æ’ 15 åˆ†é˜ç·šä¸Š demoï¼ŸæœŸå¾…æ‚¨çš„å›è¦†ï¼

Chris Wu
[ä½ çš„æ‰‹æ©Ÿ]
[ä½ çš„ Line / Email]
[ä½ çš„å…¬å¸ç¶²ç«™]`,

                `æ‚¨å¥½ï¼Œ${lead.company} çš„æ¡è³¼ / è£½é€ ä¸»ç®¡ï¼š

è²´å…¬å¸åœ¨ ${lead.area} çš„ SMT ä»£å·¥å¯¦åŠ›æœ‰ç›®å…±ç¹ï¼Œæˆ‘å€‘ç‰¹åˆ¥ç‚ºåƒè²´å» é€™æ¨£çš„é«˜æ··ç·š EMS æº–å‚™äº†æœ€æ–°è‡ªå‹•ç„ŠéŒ«æ–¹æ¡ˆã€‚

${productInfo.name} å·²åœ¨å…¨å° 120+ å®¶åŠ å·¥å» æˆåŠŸå°å…¥ã€‚

${productInfo.desc}

æƒ³äº†è§£æ›´å¤šç´°ç¯€æˆ–å®‰æ’ç¾å ´ç¤ºç¯„å—ï¼Ÿéš¨æ™‚æ­¡è¿è¯ç¹«ï¼

Chris Wu
[ä½ çš„è¯çµ¡è³‡è¨Š]`
            ];

            const randomTemplate = templates[Math.floor(Math.random() * templates.length)];
            document.getElementById('emailContent').value = randomTemplate;
            document.getElementById('emailModal').classList.remove('hidden');
            document.getElementById('emailModal').classList.add('flex');
        }

        function copyEmail() {
            const content = document.getElementById('emailContent').value;
            navigator.clipboard.writeText(content).then(() => {
                alert('âœ… å·²è¤‡è£½åˆ°å‰ªè²¼ç°¿ï¼ç›´æ¥è²¼åˆ° Gmail / Outlook å³å¯');
            });
        }

        function closeModal() {
            document.getElementById('emailModal').classList.add('hidden');
            document.getElementById('emailModal').classList.remove('flex');
        }

        // å…¶ä»–å‡½å¼ä¿æŒä¸è®Š...
        window.onload = () => {
            // åŸæœ‰åˆå§‹åŒ–...
        };
    </script>
</body>
</html>